{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Work/frontend/React/itine/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/mac/Work/frontend/React/itine/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/mac/Work/frontend/React/itine/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _localStorage$getItem;import axios from\"axios\";var baseUrl=\"https://backend-dev-itine.onrender.com/\";var client=axios.create({withCredentials:true,baseURL:\"\".concat(baseUrl),headers:{authorization:(_localStorage$getItem=localStorage.getItem(\"token\"))!==null&&_localStorage$getItem!==void 0?_localStorage$getItem:\"\",\"Content-Type\":\"application/json\",Accept:\"application/json\"}});client.interceptors.response.use(function(response){return response;},/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(error){var _localStorage$getItem2,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(![401,403].includes(error.response.status)){_context.next=10;break;}_context.next=3;return axios.get(\"\".concat(baseUrl,\"auth/refresh\"),{withCredentials:true});case 3:_yield$axios$get=_context.sent;data=_yield$axios$get.data;localStorage.setItem(\"token\",\"Bearer \".concat(data.accessToken));console.log(error.config);return _context.abrupt(\"return\",axios(_objectSpread(_objectSpread({},error.config),{},{headers:{authorization:(_localStorage$getItem2=localStorage.getItem(\"token\"))!==null&&_localStorage$getItem2!==void 0?_localStorage$getItem2:\"\"}})));case 10:return _context.abrupt(\"return\",Promise.reject(error));case 11:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());export default client;","map":{"version":3,"names":["axios","baseUrl","client","create","withCredentials","baseURL","concat","headers","authorization","_localStorage$getItem","localStorage","getItem","Accept","interceptors","response","use","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","error","_localStorage$getItem2","_yield$axios$get","data","wrap","_callee$","_context","prev","next","includes","status","get","sent","setItem","accessToken","console","log","config","abrupt","_objectSpread","Promise","reject","stop","_x","apply","arguments"],"sources":["/Users/mac/Work/frontend/React/itine/src/utils/jwtInterceptor.js"],"sourcesContent":["import axios from \"axios\";\n\nconst baseUrl = \"https://backend-dev-itine.onrender.com/\";\nconst client = axios.create({\n  withCredentials: true,\n  baseURL: `${baseUrl}`,\n  headers: {\n    authorization: localStorage.getItem(\"token\") ?? \"\",\n    \"Content-Type\": \"application/json\",\n    Accept: \"application/json\",\n  },\n});\n\nclient.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  async (error) => {\n    if ([401, 403].includes(error.response.status)) {\n      const { data } = await axios.get(`${baseUrl}auth/refresh`, {\n        withCredentials: true,\n      });\n      localStorage.setItem(\"token\", `Bearer ${data.accessToken}`);\n      console.log(error.config);\n      return axios({\n        ...error.config,\n        headers: { authorization: localStorage.getItem(\"token\") ?? \"\" },\n      });\n    } else {\n      return Promise.reject(error);\n    }\n  }\n);\n\nexport default client;\n"],"mappings":"uZAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,GAAM,CAAAC,OAAO,CAAG,yCAAyC,CACzD,GAAM,CAAAC,MAAM,CAAGF,KAAK,CAACG,MAAM,CAAC,CAC1BC,eAAe,CAAE,IAAI,CACrBC,OAAO,IAAAC,MAAA,CAAKL,OAAO,CAAE,CACrBM,OAAO,CAAE,CACPC,aAAa,EAAAC,qBAAA,CAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,UAAAF,qBAAA,UAAAA,qBAAA,CAAI,EAAE,CAClD,cAAc,CAAE,kBAAkB,CAClCG,MAAM,CAAE,kBACV,CACF,CAAC,CAAC,CAEFV,MAAM,CAACW,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC9B,SAACD,QAAQ,CAAK,CACZ,MAAO,CAAAA,QAAQ,CACjB,CAAC,6BAAAE,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CACD,SAAAC,QAAOC,KAAK,MAAAC,sBAAA,CAAAC,gBAAA,CAAAC,IAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,aACN,CAAC,GAAG,CAAE,GAAG,CAAC,CAACC,QAAQ,CAACT,KAAK,CAACP,QAAQ,CAACiB,MAAM,CAAC,EAAAJ,QAAA,CAAAE,IAAA,WAAAF,QAAA,CAAAE,IAAA,SACrB,CAAA7B,KAAK,CAACgC,GAAG,IAAA1B,MAAA,CAAIL,OAAO,iBAAgB,CACzDG,eAAe,CAAE,IACnB,CAAC,CAAC,QAAAmB,gBAAA,CAAAI,QAAA,CAAAM,IAAA,CAFMT,IAAI,CAAAD,gBAAA,CAAJC,IAAI,CAGZd,YAAY,CAACwB,OAAO,CAAC,OAAO,WAAA5B,MAAA,CAAYkB,IAAI,CAACW,WAAW,CAAE,CAAC,CAC3DC,OAAO,CAACC,GAAG,CAAChB,KAAK,CAACiB,MAAM,CAAC,CAAC,OAAAX,QAAA,CAAAY,MAAA,UACnBvC,KAAK,CAAAwC,aAAA,CAAAA,aAAA,IACPnB,KAAK,CAACiB,MAAM,MACf/B,OAAO,CAAE,CAAEC,aAAa,EAAAc,sBAAA,CAAEZ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,UAAAW,sBAAA,UAAAA,sBAAA,CAAI,EAAG,CAAC,EAChE,CAAC,iBAAAK,QAAA,CAAAY,MAAA,UAEKE,OAAO,CAACC,MAAM,CAACrB,KAAK,CAAC,2BAAAM,QAAA,CAAAgB,IAAA,MAAAvB,OAAA,GAE/B,mBAAAwB,EAAA,SAAA5B,IAAA,CAAA6B,KAAA,MAAAC,SAAA,OACH,CAAC,CAED,cAAe,CAAA5C,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}